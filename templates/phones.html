{% extends 'base.html' %}

{% block title %}Phones {% endblock%}

{% block error_block %}
{% if err %}
        <div class="alert alert-danger">
            <strong>Error!</strong> Please correct the error{{ err.errors|pluralize }} below.
            {% for field in err %}
              {% if field.errors %}
                {% for error in field.errors %}
                  <li>{{ field.name }} - {{ error|escape }}</li>
                {% endfor %}
              {% endif %}
            {% endfor %}
        </div>
    {% endif %}

{% endblock %}


{% block content %}
        {% if added %}
            <div class="alert alert-success">
                <strong>Success!</strong> Контакт добавленн.
            </div>
        {% endif %}

<div class="container">
    <h2>Телефонный Справочник</h2>
    <div class="col-sm-5">
    <button id="flip" type="button" class="btn btn-default btn-block">Новый контакт <i class="fa fa-angle-down" aria-hidden="true"></i></button>
    <div id="panel">
        <form action="" method="post">
            <label for="name">Имя:</label>
            <input type="text" class="form-control" id="name" name="contact-name">
            <label for="phone">Телефон:</label>
            <input type="text" class="form-control" id="phone" name="contact-phone_number">
            <label for="organization">Организация:</label>
            <input type="text" class="form-control" id="organization" name="contact-organization">
            <label for="email">E-Mail:</label>
            <input type="text" class="form-control" id="email" name="contact-email">
            <label for="description">Комментарий:</label>
            <textarea type="text" class="form-control" raws="3" id="description" name="contact-description"></textarea>

            <br>
            <p class="bg-info">Не обязательно заполнять все поля</p>
            <br>
            <button type="submit" class="btn btn-success btn-block">Добавить</button>
      </div>
    </div>
            </div>

            {% csrf_token %}
        </form>
    </div>


    <br>
    <div class="row">
        <div class="col-sm-2">
        </div>
        <div class="col-md-9">
            <form action="" method="get">
            <table class="table table-hover table-condensed">
                <thead>
                <tr>
                    <th><p>Телефон</p></th>
                    <th><p>Сотрудник</p></th>
                    <th><p>Организация</p></th>
                    <th><p>Комментарий</p></th>
                    <th><p>E-Mail</p></th>
                    <th></th>
                </tr>
                {% for contact in contacts %}
                {% if contact.id|slugify == edit_id|slugify %}
                <tr>
                    <form action="" method="post">
                    <td><input type="text" class="form-control" name="update-phone_number" value={{ contact.phone_number }}></td>
                    <td><input type="text" class="form-control" name="update-name" value={{ contact.name }}></td>
                    <td><input type="text" class="form-control" name="update-organization" value={{ contact.organization }}></td>
                    <td><input type="text" class="form-control" name="update-description" value={{ contact.description }}></td>
                    <td><input type="text" class="form-control" name="update-email" value={{ contact.email }}></td>
                    <td><button type="submit" name="new" value={{ contact.id }} class="btn btn-success btn-block btn-xs"><i class="fa fa-check" aria-hidden="true"></i> Обновить</button></td>
                    <td><a href="/phones" class="btn  btn-block btn-xs"><i class="fa fa-times-circle-o" aria-hidden="true"></i> Отмена</a></td>
                    </form>
                </tr>
                {% else %}
                <tr>
                    <td class="col-md-1">{{ contact.phone_number }}</td>
                    <td class="col-md-2">{{ contact.name }}</td>
                    <td><button type="submit" class="btn btn-link" name="q" value={{ contact.organization }}>{{ contact.organization }}</td>
                    <td class="col-md-7">{{ contact.description }}</td>
                    <td>{{ contact.email }}</td>
                    <td><button type="submit" name="edit" value={{ contact.id }} class="btn btn-warning btn-block btn-xs"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Редактировать</button></td>
                    <td><button type="submit" name="del" value={{ contact.id }} class="btn btn-danger btn-block btn-xs" onclick="return confirm('Are you sure?')"><i class="fa fa-trash-o fa-lg"></i> Удалить</button></td>
                </tr>
                {% endif %}
                {% endfor %}
                </tbody>
            </table>
            </form>
        </div>
    </div>





<script>
$(document).ready(function(){
    $("#flip").click(function(){
        $("#panel").slideToggle("slow");
    });
});
</script>

<style>
#panel, #flip {
    padding: 5px;
    <!--text-align: center;-->
    <!--background-color: #e5eecc;-->
    <!--border: solid 1px #c3c3c3;-->
}

#panel {
    padding: 50px;
    display: none;
}
</style>

{% endblock %}